{% extends "base.html" %}
{% block title %}{{ t('–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç') }}{% endblock %}
{% block content %}
<section class="profile-section">
  <div class="profile-card wide">
    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ + –∞–≤–∞—Ç–∞—Ä -->
    <div class="profile-header">
      <div class="avatar-circle">
        <i class="fas fa-user"></i>
      </div>
      <div>
        <h2>{{ user.name }}</h2>
        <p class="subtitle">{{ user.email }}</p>
      </div>
<a href="{{ url_for('logout') }}" class="logout-btn" title="{{ t('–í—ã–π—Ç–∏') }}">
  <i class="fas fa-sign-out-alt"></i>
</a>
    </div>

    <div class="profile-grid">
      <!-- –õ–µ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ -->
      <div class="profile-info">
        <div class="info-item">
          <span class="label">{{ t('–†–æ–ª—å:') }}</span>
          <span class="value">{{ user.is_admin and t('–ê–¥–º–∏–Ω') or t('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å') }}</span>
        </div>

        <div class="info-item">
          <span class="label">{{ t('–ï–ù–¢ –±–∞–ª–ª—ã:') }}</span>
          <span class="value highlight">{{ user.ent_total }}</span>
        </div>

        {% if result %}
        <div class="info-item">
          <span class="label">{{ t('–¢–∏–ø –ª–∏—á–Ω–æ—Å—Ç–∏ (MBTI):') }}</span>
          <span class="value mbti">{{ result.mbti_type }}</span>
        </div>

        <!-- –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä -->
        <div class="progress-container">
          <div class="progress-label">
  {{ t('–ü–æ—Ä–æ–≥ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è:') }} <strong>85</strong> / 140
</div>
          <div class="progress-bar">
            <div class="progress-fill" style="width: {{ (user.ent_total / 140 * 100)|round(0) }}%"></div>
          </div>
        </div>
        {% endif %}
      </div>

      <!-- –ü—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ -->
      <div class="profile-actions-column">
        {% if result %}
        <div class="recommendations">
          <h4>{{ t('–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏') }}</h4>

          {% set rec = result.recommended_programs | safe | from_json %}
          <p class="suggestions">{{ rec.description }}</p>

          {% if rec.programs %}
          <ul class="recommended-list">
            {% for prog in rec.programs %}
            <li>üìò {{ prog }}</li>
            {% endfor %}
          </ul>
          {% endif %}
        </div>
        {% else %}
        <div class="no-result">
          <p>{{ t('–í—ã –µ—â—ë –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏–ª–∏ –ø—Å–∏—Ö–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Ç–µ—Å—Ç.') }}</p>
<a href="{{ url_for('test_psy') }}" class="btn orange">{{ t('–ü—Ä–æ–π—Ç–∏ —Ç–µ—Å—Ç') }}</a>
        </div>
        {% endif %}

        <div class="quick-actions">
          <a href="{{ url_for('calculator') }}" class="action-card">
            <i class="fas fa-calculator"></i>
            <span>{{ t('–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –ï–ù–¢') }}</span>
          </a>
          <a href="{{ url_for('status') }}" class="action-card">
            <i class="fas fa-file-alt"></i>
           <span>{{ t('–°—Ç–∞—Ç—É—Å –∑–∞—è–≤–∫–∏') }}</span>
          </a>
        </div>
      </div>
    </div>
  </div>
</section>


{% endblock %}
